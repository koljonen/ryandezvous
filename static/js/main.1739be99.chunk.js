(this.webpackJsonpryandezvous=this.webpackJsonpryandezvous||[]).push([[0],{101:function(t,e,a){t.exports=a(140)},106:function(t,e,a){},108:function(t,e,a){},140:function(t,e,a){"use strict";a.r(e);var r=a(0),n=a.n(r),i=a(9),o=a.n(i),u=(a(106),a(59)),s=a(37),c=a(18),l=a(20),d=a(16),m=a.n(d),p=(a(108),a(13)),h=a.n(p),f=a(76),g=a(7),D=a(24),v=a(17),b=a(29),y=a(31),E=a(21),x=a(32),w=a(77),A=a.n(w),k=a(177),S=a(15),L=a(181),j=a(60),O=a(179),C=a(180),M=a(182),_=a(82),F=a.n(_),Y=a(178),T=a(170),I=a(78),P=a.n(I),R=a(79),q=a.n(R),H=a(80),z=a.n(H),V=Object(T.a)((function(t){return{icon:{color:t.palette.text.secondary,marginRight:t.spacing(2)}}}));function W(t){var e,a,r,n,i;return h.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return e=t.term,a=t.id,r="https://kiwiproxy.herokuapp.com/locations/"+(a?"id?id=".concat(a):"/query?&term=".concat(e)),o.next=4,h.a.awrap(fetch(r));case 4:return n=o.sent,o.next=7,h.a.awrap(n.json());case 7:return i=o.sent,o.abrupt("return",i.locations.map((function(t){return Object.assign(t,{input:e||a})})));case 9:case"end":return o.stop()}}))}function B(t){var e=V(),a=n.a.useState(""),r=Object(l.a)(a,2),i=r[0],o=r[1],u=n.a.useState([]),s=Object(l.a)(u,2),c=s[0],d=s[1],m=function(t,e){o(t.target.value)},p=n.a.useMemo((function(){return z()((function(t,e){var a;return h.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,h.a.awrap(W({term:t}));case 2:a=r.sent,e(a);case 4:case"end":return r.stop()}}))}),200)}),[]);return n.a.useEffect((function(){var t=!0;if(""!==i)return p(i,(function(e){t&&d(e||[])})),function(){t=!1};d([])}),[i,p]),n.a.createElement(M.a,{style:{width:"240px"},getOptionLabel:function(t){return"string"===typeof t?t:t.name},filterOptions:function(t){return t},options:c,onChange:function(e,a){t.onChange({target:{name:t.name,value:a}})},value:t.value,renderInput:function(e){return n.a.createElement(C.a,Object.assign({required:t.required},e,{label:t.label,variant:"outlined",fullWidth:!0,onChange:m}))},renderOption:function(t){var a=P()(t.name,q()(t.name,t.input));return n.a.createElement(k.a,{container:!0,alignItems:"center"},n.a.createElement(k.a,{item:!0},n.a.createElement(F.a,{className:e.icon})),n.a.createElement(k.a,{item:!0,xs:!0},a.map((function(t,e){return n.a.createElement("span",{key:e,style:{fontWeight:t.highlight?700:400}},t.text)})),n.a.createElement(Y.a,{variant:"body2",color:"textSecondary"},t.name)))}})}function J(){return m()().add((m()().isoWeekday()>=4?12:4)-m()().isoWeekday(),"days")}var N=["departureDate","returnDate","myAirport","herAirport"],U=function(t){function e(t){var a,r,n,i;function o(t,e){var a,r,n;return h.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(!e[t]){i.next=9;break}return a="https://kiwiproxy.herokuapp.com/locations/id?id=".concat(e[t]),i.next=4,h.a.awrap(fetch(a));case 4:return r=i.sent,i.next=7,h.a.awrap(r.json());case 7:n=i.sent,e[t]=n.locations.filter((function(a){return a.code===e[t]}))[0];case 9:case"end":return i.stop()}}))}return Object(D.a)(this,e),(a=Object(b.a)(this,Object(y.a)(e).call(this,t))).handleChange=function(t){this.setState(Object(g.a)({},t.target.name,t.target.value))},a.renderInput=function(t){return t.name},a.state=Object(f.a)({departureDate:J(),returnDate:J().add(4,"days"),destinationAirport:""},t.match.params),a.state.departureDate=m()(a.state.departureDate),a.state.returnDate=m()(a.state.returnDate),a.allowSubmit=a.allowSubmit.bind(Object(E.a)(a)),a.startLoading=t.startLoading,a.finishLoading=t.finishLoading,a.handleChange=a.handleChange.bind(Object(E.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(E.a)(a)),a.doStuff=a.doStuff.bind(Object(E.a)(a)),a.setDepartureDate=a.setDepartureDate.bind(Object(E.a)(a)),r=a.state,n=a.allowSubmit,i=a.doStuff,h.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.a.awrap(o("myAirport",r));case 2:return t.next=4,h.a.awrap(o("herAirport",r));case 4:n()&&i();case 5:case"end":return t.stop()}})),a}return Object(x.a)(e,t),Object(v.a)(e,[{key:"handleSubmit",value:function(t){t.preventDefault()}},{key:"allowSubmit",value:function(){var t=this;return N.reduce((function(e,a){return e&&!!t.state[a]}),!0)&&!this.props.loading}},{key:"setDepartureDate",value:function(t){t>this.state.returnDate&&this.setState({returnDate:this.state.returnDate+(t-this.state.departureDate)}),this.setState({departureDate:t})}},{key:"doStuff",value:function(){var t;return h.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return this.startLoading(),this.props.clearCandidates(),this.props.history.push("/".concat(this.state.myAirport.id,"/")+"".concat(this.state.herAirport.id,"/")+"".concat(this.state.departureDate.format("YYYY-MM-DD"),"/")+"".concat(this.state.returnDate.format("YYYY-MM-DD"),"/")+(this.state.destinationAirport&&this.state.destinationAirport.id?"".concat(this.state.destinationAirport.id):"")),e.next=5,h.a.awrap(Q(this.state));case 5:t=e.sent,this.props.addCandidates(t),this.finishLoading();case 8:case"end":return e.stop()}}),null,this)}},{key:"render",value:function(){var t=this;return n.a.createElement("form",{onSubmit:this.handleSubmit},n.a.createElement(k.a,{container:!0,spacing:2},n.a.createElement(k.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(S.a,{name:"departureDate",utils:j.a},n.a.createElement(L.a,{required:!0,disablePast:!0,variant:"inline",label:"Departure",value:this.state.departureDate,inputVariant:"outlined",onChange:this.setDepartureDate}))),n.a.createElement(k.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(S.a,{name:"returnDate",utils:j.a},n.a.createElement(L.a,{required:!0,variant:"inline",label:"Return",value:this.state.returnDate,inputVariant:"outlined",onChange:function(e){return t.setState({returnDate:e})},minDate:this.state.departureDate}))),n.a.createElement(k.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(B,{startLoading:this.startLoading,finishLoading:this.finishLoading,required:!0,id:"myAirport",name:"myAirport",value:this.state.myAirport,onChange:this.handleChange,label:"Your origin",renderInput:this.renderInput})),n.a.createElement(k.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(B,{startLoading:this.startLoading,finishLoading:this.finishLoading,required:!0,id:"herAirport",name:"herAirport",value:this.state.herAirport,onChange:this.handleChange,label:"Their origin",renderInput:this.renderInput})),n.a.createElement(k.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(B,{startLoading:this.startLoading,finishLoading:this.finishLoading,id:"destinationAirport",name:"destinationAirport",value:this.state.destinationAirport,onChange:this.handleChange,label:"Destination",renderInput:this.renderInput})),n.a.createElement(k.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(O.a,{variant:"contained",color:"primary",disabled:!this.allowSubmit(),onClick:this.doStuff},"Search"))))}}]),e}(n.a.Component);function G(t){return m()(t).format("DD/MM/YYYY")}function K(t,e){var a;return h.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return a=A()("https://kiwiproxy.herokuapp.com",{path:"v2/search",queryParams:{fly_from:t.id,dateFrom:G(e.departureDate),dateTo:G(e.departureDate),returnFrom:G(e.returnDate),returnTo:G(e.returnDate),curr:"EUR",ret_from_diff_airport:0,fly_to:e.destinationAirport?e.destinationAirport.id:void 0,max_stopovers:0}}).replace(/%2F/g,"/"),r.t0=h.a,r.next=4,h.a.awrap(fetch(a));case 4:return r.t1=r.sent.json(),r.next=7,r.t0.awrap.call(r.t0,r.t1);case 7:return r.abrupt("return",r.sent.data);case 8:case"end":return r.stop()}}))}function Q(t){var e,a,r,n;return h.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return e=[],a=function(t,a){var r=new Date(t.route[0].local_arrival),n=new Date(a.route[0].local_arrival),i=new Date(t.route[t.route.length-1].local_arrival),o=new Date(a.route[a.route.length-1].local_arrival),u=Math.abs(r-n),s=Math.abs(i-o),c=Math.min(i,o)-Math.max(r,n),l=u+s;u+s>1296e5||t.cityCodeTo===a.cityCodeTo&&(c<864e5||c<=l||e.push({day:t.route[0].local_departure,destination:t.cityTo+", "+t.countryTo.name,myArrivalDate:t.route[0].local_arrival,herArrivalDate:a.route[0].local_arrival,myReturnDate:t.route[t.route.length-1].local_arrival,herReturnDate:a.route[a.route.length-1].local_arrival,myDepartureDate:t.route[0].local_departure,herDepartureDate:a.route[0].local_departure,price:t.price+a.price,timeApart:m.a.duration(l),timeTogether:m.a.duration(c),myLink:t.deep_link,herLink:a.deep_link}))},i.next=4,h.a.awrap(K(t.myAirport,t));case 4:return r=i.sent,i.next=7,h.a.awrap(K(t.herAirport,t));case 7:return n=i.sent,r.forEach((function(t){n.forEach((function(e){a(t,e)}))})),i.abrupt("return",e);case 10:case"end":return i.stop()}}))}var X=Object(s.f)(U),Z=(a(126),a(127),a(84));function $(t){var e=[{title:"Price",field:"price",formatter:"money",formatterParams:{symbol:"\u20ac",precision:0},headerFilter:!0,headerFilterFunc:function(t,e){return t>=e}},{title:"Destination",field:"destination",headerFilter:!0},{title:"You",columns:[{title:"Arrival",field:"myArrivalDate",align:"center",formatter:"datetime",formatterParams:{outputFormat:"ddd DD MMM HH:mm"}},{title:"Return",field:"myReturnDate",align:"center",formatter:"datetime",formatterParams:{outputFormat:"ddd DD MMM HH:mm"}},{title:"Link",field:"myLink",formatter:"link",formatterParams:{label:"Buy",target:"_blank"}}]},{title:"Them",columns:[{title:"Arrival",field:"herArrivalDate",align:"center",formatter:"datetime",formatterParams:{outputFormat:"ddd DD MMM HH:mm"}},{title:"Return",field:"herReturnDate",align:"center",formatter:"datetime",formatterParams:{outputFormat:"ddd DD MMM HH:mm"}},{title:"Link",field:"herLink",formatter:"link",formatterParams:{label:"Buy",target:"_blank"}}]},{title:"Together",field:"timeTogether",formatter:function(t,e,a){return t.getValue().humanize()},sorter:function(t,e){return t.asSeconds()-e.asSeconds()},headerFilter:!0,headerFilterFunc:function(t,e){return tt(t)<=e}},{title:"Apart",field:"timeApart",formatter:function(t,e,a){return t.getValue().humanize()},sorter:function(t,e){return t.asSeconds()-e.asSeconds()},headerFilter:!0,headerFilterFunc:function(t,e){return tt(t)>=e}}];return n.a.createElement(Z.ReactTabulator,{data:t.candidates,columns:e,options:{height:"100%",layout:"fitColumns",reactiveData:!0}})}function tt(t){var e=t.split(" "),a="a"===e[0]||"an"===e[0]?1:parseInt(e[0]),r="s"===e[1][e[1].length-1]?e[1]:e[1]+"s";return m.a.duration(a,r)}function et(t){return n.a.createElement("div",{id:t.id},t.loading?"\u2708":"")}window.moment=m.a,m.a.updateLocale("en",{week:{dow:1}});var at=function(t){var e=n.a.useState(0),a=Object(l.a)(e,2),r=a[0],i=a[1],o=n.a.useState([]),u=Object(l.a)(o,2),s=u[0],d=u[1];return n.a.createElement("div",null,n.a.createElement(X,{addCandidates:function(t){return d([].concat(Object(c.a)(s),Object(c.a)(t)))},clearCandidates:function(){return d([])},startLoading:function(){return i(r+1)},finishLoading:function(){return i(r-1)},loading:r>0}),n.a.createElement(et,{id:"loading",loading:r>0}),n.a.createElement($,{candidates:s}))},rt=n.a.createElement(u.a,null,n.a.createElement("div",null,n.a.createElement(s.c,null,n.a.createElement(s.a,{exact:!0,path:"/:myAirport/:herAirport/:departureDate/:returnDate",component:at}),n.a.createElement(s.a,{exact:!0,path:"/:myAirport/:herAirport/:departureDate/:returnDate/:destinationAirport",component:at}),n.a.createElement(s.a,{exact:!0,path:"/",component:at}))));o.a.render(rt,document.getElementById("root"))}},[[101,1,2]]]);
//# sourceMappingURL=main.1739be99.chunk.js.map