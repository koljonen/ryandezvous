{"version":3,"sources":["AirportSelector.js","Form.js","ResultsTable.js","App.js","index.js"],"names":["useStyles","makeStyles","theme","icon","color","palette","text","secondary","marginRight","spacing","locationSearch","a","async","term","id","url","fetch","locationJson","json","locations","map","location","Object","assign","AirportSelector","props","classes","React","useState","inputValue","setInputValue","value","setValue","options","setOptions","fetchedDefault","setFetchedDefault","handleSearch","event","target","handleChange","onChange","name","ourFetch","useMemo","throttle","input","callback","useEffect","active","selectedLocation","filter","x","code","undefined","mjau","required","results","Autocomplete","style","width","getOptionLabel","option","filterOptions","renderInput","params","TextField","label","variant","fullWidth","renderOption","parts","parse","match","Grid","container","alignItems","item","className","xs","part","index","key","fontWeight","highlight","Typography","nextThursday","moment","add","isoWeekday","formatKiwiDate","date","format","getFaresFromAirport","airport","state","fareURL","buildUrl","path","queryParams","fly_from","dateFrom","departureDate","dateTo","returnFrom","returnDate","returnTo","curr","ret_from_diff_airport","fly_to","destinationAirport","max_stopovers","replace","data","getFares","candidates","maybeAdd","myFare","herFare","myArrival","Date","route","local_arrival","herArrival","myReturn","length","herReturn","arrivalDiff","Math","abs","returnDiff","msTogether","min","max","msApart","maxDiffHours","cityCodeTo","push","day","local_departure","destination","cityTo","countryTo","myArrivalDate","herArrivalDate","myReturnDate","herReturnDate","myDepartureDate","herDepartureDate","price","timeApart","duration","timeTogether","myLink","deep_link","herLink","myAirport","myFares","herAirport","herFares","forEach","Form","e","this","setState","setLoading","bind","handleSubmit","doStuff","preventDefault","clearCandidates","history","newCandidates","addCandidates","onSubmit","sm","md","xl","utils","MomentUtils","DatePicker","inputVariant","d","Button","onClick","Component","ResultsTable","columns","title","field","formatter","formatterParams","symbol","precision","headerFilter","headerFilterFunc","headerValue","rowValue","align","outputFormat","cell","onRendered","getValue","humanize","sorter","b","asSeconds","parseDuration","height","layout","reactiveData","s","split","numberPart","parseInt","unitPart","window","updateLocale","week","dow","Loading","loading","App","setCandidates","routing","exact","component","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.403be3fb.chunk.js","sourcesContent":["import React from 'react';\nimport TextField from '@material-ui/core/TextField';\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport LocationOnIcon from '@material-ui/icons/LocationOn';\nimport Grid from '@material-ui/core/Grid';\nimport Typography from '@material-ui/core/Typography';\nimport { makeStyles } from '@material-ui/core/styles';\nimport parse from 'autosuggest-highlight/parse';\nimport match from 'autosuggest-highlight/match';\nimport throttle from 'lodash/throttle';\n\nconst useStyles = makeStyles(theme => ({\n    icon: {\n        color: theme.palette.text.secondary,\n        marginRight: theme.spacing(2),\n    },\n}));\n\nasync function locationSearch({term, id}) {\n    const url = 'https://kiwiproxy.herokuapp.com/locations/' + (id ? `id?id=${id}` : `/query?&term=${term}`);\n    const locationJson = await fetch(url);\n    const locations = await locationJson.json();\n    return locations.locations.map(location => Object.assign(location, {'input': term || id}))\n}\n\nexport default function AirportSelector(props) {\n    const classes = useStyles();\n    const [inputValue, setInputValue] = React.useState('');\n    const [value, setValue] = React.useState('');\n    const [options, setOptions] = React.useState([]);\n    const [fetchedDefault, setFetchedDefault] = React.useState(false);\n\n    const handleSearch = (event, value) => {\n        setInputValue(event.target.value);\n    };\n\n    const handleChange = (event, value) => {\n        setValue(value);\n        props.onChange({\n            target:{\n                name: props.name,\n                value: value\n            }\n        });\n    }\n\n    const ourFetch = React.useMemo(\n        () => throttle(\n            async function(input, callback) {\n                const locations = await locationSearch({term: input});\n                callback(locations);\n            },\n            200\n        ),\n        [],\n    );\n\n    React.useEffect(\n        () => {\n            let active = true;\n            if(!fetchedDefault) {\n                setFetchedDefault(true);\n                if(props.value) {\n                    const mjau = async() => {\n                        const locations = await locationSearch({id: props.value});\n                        setOptions(locations);\n                        const selectedLocation = locations.filter(\n                            x => x.code === props.value || x.id === props.value\n                        )[0];\n                        handleChange(undefined, selectedLocation);\n                    };\n                    mjau();\n                    return;\n                }\n                else if(!props.required) {\n                    handleChange(undefined, {name:\"Anywhere\", code: \"\"});\n                }\n            }\n            else if (inputValue === '') {\n                setOptions([]);\n                return undefined;\n            }\n            ourFetch(\n                inputValue,\n                results => {\n                    if (active) {\n                        setOptions(results || []);\n                    }\n                }\n            );\n\n            return () => {\n                active = false;\n            };\n        },\n        [inputValue, ourFetch, fetchedDefault, props.value, props.required]\n    );\n\n    return (\n        <Autocomplete\n            style={{ width: \"240px\" }}\n            getOptionLabel={option => (typeof option === 'string' ? option : option.name)}\n            filterOptions={x => x}\n            options={options}\n            onChange={handleChange}\n            value={value}\n            renderInput={params => (\n                <TextField\n                    required={props.required}\n                    {...params}\n                    label={props.label}\n                    variant=\"outlined\"\n                    fullWidth\n                    onChange={handleSearch}\n                />\n            )}\n            renderOption={option => {\n                const parts = parse(\n                    option.name,\n                    match(option.name, option.input)\n                );\n\n                return (\n                    <Grid container alignItems=\"center\">\n                        <Grid item>\n                            <LocationOnIcon className={classes.icon} />\n                        </Grid>\n                        <Grid item xs>\n                            {parts.map((part, index) => (\n                                <span key={index} style={{ fontWeight: part.highlight ? 700 : 400 }}>\n                                    {part.text}\n                                </span>\n                            ))}\n\n                            <Typography variant=\"body2\" color=\"textSecondary\">\n                                {option.name}\n                            </Typography>\n                        </Grid>\n                    </Grid>\n                );\n            }}\n        />\n    );\n}\n","import buildUrl from 'build-url';\nimport Grid from '@material-ui/core/Grid';\nimport {\n  MuiPickersUtilsProvider,\n  DatePicker\n} from '@material-ui/pickers';\nimport MomentUtils from '@date-io/moment';\nimport moment from \"moment\";\nimport Button from '@material-ui/core/Button';\nimport React from 'react';\nimport AirportSelector from './AirportSelector.js';\n\nfunction nextThursday() {\n    return moment().add((moment().isoWeekday() >= 4  ? 12 : 4) - moment().isoWeekday(), 'days');\n}\n\nclass Form extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            departureDate: nextThursday(),\n            returnDate: nextThursday().add(4, 'days'),\n            destinationAirport: \"\",\n            ...props.match.params\n        };\n        this.state.departureDate = moment(this.state.departureDate);\n        this.state.returnDate = moment(this.state.returnDate);\n        this.setLoading = props.setLoading;\n        this.handleChange = this.handleChange.bind(this);\n        this.handleSubmit = this.handleSubmit.bind(this);\n        this.doStuff = this.doStuff.bind(this);\n    }\n\n    handleChange = function(e) {\n        this.setState({ [e.target.name]: e.target.value });\n    }\n\n    handleSubmit(event) {\n        event.preventDefault();\n    }\n\n    async doStuff() {\n        this.setLoading(true);\n        this.props.clearCandidates();\n        this.props.history.push(\n            `/${this.state.myAirport.id}/` +\n            `${this.state.herAirport.id}/` +\n            `${this.state.departureDate.format('YYYY-MM-DD')}/` +\n            `${this.state.returnDate.format('YYYY-MM-DD')}/` +\n            (this.state.destinationAirport && this.state.destinationAirport.id ? `${this.state.destinationAirport.id}` : '')\n        );\n        const newCandidates = await getFares(this.state);\n        this.props.addCandidates(newCandidates);\n        this.setLoading(false);\n    }\n\n    renderInput = input => input.name;\n\n    render() {\n        return (\n            <form onSubmit={this.handleSubmit} >\n                <Grid container spacing={2}>\n                    <Grid item sm={6} md={3} xl={2}>\n                        <MuiPickersUtilsProvider name=\"departureDate\" utils={MomentUtils}>\n                            <DatePicker required variant=\"inline\" label=\"Departure\" value={this.state.departureDate} inputVariant=\"outlined\" onChange={d => this.setState({departureDate: d})}/>\n                            </MuiPickersUtilsProvider>\n                    </Grid>\n                    <Grid item sm={6} md={3} xl={2}>\n                        <MuiPickersUtilsProvider name=\"returnDate\" utils={MomentUtils}>\n                            <DatePicker required variant=\"inline\" label=\"Return\" value={this.state.returnDate} inputVariant=\"outlined\" onChange={d => this.setState({returnDate: d})}/>\n                            </MuiPickersUtilsProvider>\n                    </Grid>\n                    <Grid item sm={6} md={3} xl={2}>\n                        <AirportSelector\n                            required\n                            id=\"myAirport\"\n                            name=\"myAirport\"\n                            value={this.state.myAirport}\n                            onChange={this.handleChange}\n                            label=\"Your origin\"\n                            renderInput={this.renderInput}\n                        />\n                    </Grid>\n                    <Grid item sm={6} md={3} xl={2}>\n                        <AirportSelector\n                            required\n                            id=\"herAirport\"\n                            name=\"herAirport\"\n                            value={this.state.herAirport}\n                            onChange={this.handleChange}\n                            label=\"Their origin\"\n                            renderInput={this.renderInput}\n                        />\n                    </Grid>\n                    <Grid item sm={6} md={3} xl={2}>\n                        <AirportSelector\n                            id=\"destinationAirport\"\n                            name=\"destinationAirport\"\n                            value={this.state.destinationAirport}\n                            onChange={this.handleChange}\n                            label=\"Destination\"\n                            renderInput={this.renderInput}\n                        />\n                    </Grid>\n                    <Grid item sm={6} md={3} xl={2}>\n                        <Button variant=\"contained\" color=\"primary\" onClick={this.doStuff}>Search</Button>\n                    </Grid>\n                </Grid>\n                \n            </form>\n        );\n    }\n}\n\nfunction formatKiwiDate(date) {\n    return moment(date).format('DD/MM/YYYY');\n}\n\nasync function getFaresFromAirport(airport, state) {\n    const fareURL = buildUrl(\n        'https://kiwiproxy.herokuapp.com',\n        {\n            path: \"v2/search\",\n            queryParams: {\n                fly_from: airport.id,\n                dateFrom: formatKiwiDate(state.departureDate),\n                dateTo: formatKiwiDate(state.departureDate),\n                returnFrom: formatKiwiDate(state.returnDate),\n                returnTo: formatKiwiDate(state.returnDate),\n                curr: 'EUR',\n                ret_from_diff_airport: 0,\n                fly_to: state.destinationAirport ? state.destinationAirport.id : undefined,\n                max_stopovers: 0\n            }\n        }\n    ).replace(/%2F/g, '/');\n    return (await (await fetch(fareURL)).json()).data;\n}\n\nasync function getFares(state) {\n    const candidates = [];\n    var maybeAdd = function(myFare, herFare) {\n        const maxDiffHours = 36;\n        const myArrival = new Date(myFare.route[0].local_arrival);\n        const herArrival = new Date(herFare.route[0].local_arrival);\n        const myReturn = new Date(myFare.route[myFare.route.length - 1].local_arrival);\n        const herReturn = new Date(herFare.route[herFare.route.length - 1].local_arrival);\n        const arrivalDiff = Math.abs(myArrival - herArrival);\n        const returnDiff = Math.abs(myReturn - herReturn);\n        const msTogether = Math.min(myReturn, herReturn) - Math.max(myArrival, herArrival);\n        const msApart = arrivalDiff + returnDiff;\n        if(arrivalDiff + returnDiff > maxDiffHours * 60 * 60 * 1000) return;\n        if(myFare.cityCodeTo !== herFare.cityCodeTo) return;\n        if(msTogether < 24 * 60 * 60 * 1000) return;\n        if(msTogether <= msApart) return;\n        candidates.push({\n            day: myFare.route[0].local_departure,\n            destination: myFare.cityTo + ', ' + myFare.countryTo.name,\n            myArrivalDate: myFare.route[0].local_arrival,\n            herArrivalDate: herFare.route[0].local_arrival,\n            myReturnDate: myFare.route[myFare.route.length - 1].local_arrival,\n            herReturnDate: herFare.route[herFare.route.length - 1].local_arrival,\n            myDepartureDate: myFare.route[0].local_departure,\n            herDepartureDate: herFare.route[0].local_departure,\n            price: myFare.price + herFare.price,\n            timeApart: moment.duration(msApart),\n            timeTogether: moment.duration(msTogether),\n            myLink: myFare.deep_link,\n            herLink: herFare.deep_link\n        });\n    };\n    const myFares = await getFaresFromAirport(state.myAirport, state);\n    const herFares = await getFaresFromAirport(state.herAirport, state);\n    myFares.forEach(\n        function(myFare) {\n            herFares.forEach(\n                function(herFare){\n                    maybeAdd(myFare, herFare);\n                }\n            );\n        }\n    );\n    return candidates;\n}\n\nexport default Form;\n","import moment from \"moment\";\nimport React from 'react';\nimport 'react-tabulator/lib/styles.css';\nimport 'react-tabulator/lib/css/tabulator.min.css';\nimport { ReactTabulator } from 'react-tabulator';\n\nexport default function ResultsTable(props) {\n    const columns = [\n        {\n            title: \"Price\",\n            field: \"price\",\n            formatter: \"money\",\n            formatterParams: {\n                symbol: \"€\",\n                precision: 0\n            },\n            headerFilter: true,\n            headerFilterFunc: (headerValue, rowValue) => headerValue >= rowValue,\n        },\n        {\n            title: \"Destination\",\n            field: \"destination\",\n            headerFilter: true\n        },\n        {\n            title: \"You\",\n            columns: [\n                {\n                    title: \"Arrival\",\n                    field: \"myArrivalDate\",\n                    align: \"center\",\n                    formatter:\"datetime\",\n                    formatterParams: {\n                        outputFormat:\"ddd DD MMM HH:mm\"\n                    },\n                },\n                {\n                    title: \"Return\",\n                    field: \"myReturnDate\",\n                    align: \"center\",\n                    formatter:\"datetime\",\n                    formatterParams: {\n                        outputFormat:\"ddd DD MMM HH:mm\"\n                    },\n                },\n                {\n                    title: \"Link\",\n                    field: \"myLink\",\n                    formatter:\"link\",\n                    formatterParams: {\n                        label: \"Buy\",\n                        target: \"_blank\",\n                    }\n                },\n            ]\n        },\n        {\n            title: \"Them\",\n            columns: [\n                {\n                    title: \"Arrival\",\n                    field: \"herArrivalDate\",\n                    align: \"center\",\n                    formatter:\"datetime\",\n                    formatterParams: {\n                        outputFormat:\"ddd DD MMM HH:mm\"\n                    },\n                },\n                {\n                    title: \"Return\",\n                    field: \"herReturnDate\",\n                    align: \"center\",\n                    formatter:\"datetime\",\n                    formatterParams: {\n                        outputFormat:\"ddd DD MMM HH:mm\"\n                    },\n                },\n                {\n                    title: \"Link\",\n                    field: \"herLink\",\n                    formatter:\"link\",\n                    formatterParams: {\n                        label: \"Buy\",\n                        target: \"_blank\",\n                    }\n                },\n            ]\n        },\n        {\n            title: \"Together\",\n            field: \"timeTogether\",\n            formatter: function(cell, formatterParams, onRendered){\n                return cell.getValue().humanize();\n            },\n            sorter: (a, b) => a.asSeconds() - b.asSeconds(),\n            headerFilter: true,\n            headerFilterFunc: (headerValue, rowValue) => parseDuration(headerValue) <= rowValue,\n        },\n        {\n            title: \"Apart\",\n            field: \"timeApart\",\n            formatter: function(cell, formatterParams, onRendered){\n                return cell.getValue().humanize();\n            },\n            sorter: (a, b) => a.asSeconds() - b.asSeconds(),\n            headerFilter: true,\n            headerFilterFunc: (headerValue, rowValue) => parseDuration(headerValue) >= rowValue,\n        },\n    ];\n    return (\n        <ReactTabulator\n            data={props.candidates}\n            columns={columns}\n            options={{\n                height:\"100%\",\n                layout:\"fitColumns\",\n                reactiveData:true,\n            }}\n        />\n  );\n}\n\nfunction parseDuration(s) {\n    const parts = s.split(' ');\n    const numberPart = parts[0] === 'a' || parts[0] === 'an' ? 1 : parseInt(parts[0]);\n    const unitPart =  parts[1][parts[1].length -1] === 's' ? parts[1] : parts[1] + 's';\n    return moment.duration(numberPart, unitPart);\n}\n","import moment from \"moment\";\nimport React from 'react';\nimport './App.css';\nimport Form from './Form.js';\nimport ResultsTable from './ResultsTable.js';\n\n// for tabulator\nwindow.moment = moment;\nmoment.updateLocale('en', {\n  week: {\n    dow: 1,\n  },\n})\n\nconst candidates = [];\n\nfunction App(props) {\n    const [loading, setLoading] = React.useState(false);\n    const [candidates, setCandidates] = React.useState([]);\n    const addCandidates = (newCandidates) => setCandidates([...candidates, ...newCandidates]);\n    const clearCandidates = () => setCandidates([]);\n    return (\n        <div>\n            <Form\n                addCandidates={addCandidates}\n                clearCandidates={clearCandidates}\n                setLoading={setLoading}\n                {...props}\n            />\n            <Loading id=\"loading\" loading={loading}/>\n            <ResultsTable candidates={candidates}/>\n        </div>\n  );\n}\n\nfunction Loading(props) {\n    return <div id={props.id}>{props.loading ? '✈' : ''}</div>;\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport { Switch, Route, HashRouter as Router } from 'react-router-dom'\nimport App from './App'\n\nconst routing = (\n  <Router>\n    <div>\n        <Switch>\n            <Route exact path=\"/:myAirport/:herAirport/:departureDate/:returnDate\" component={App} />\n            <Route exact path=\"/:myAirport/:herAirport/:departureDate/:returnDate/:destinationAirport\" component={App} />\n            <Route exact path=\"/\" component={App} />\n        </Switch>\n    </div>\n  </Router>\n)\n\nReactDOM.render(routing, document.getElementById('root'))\n"],"sourceRoot":""}