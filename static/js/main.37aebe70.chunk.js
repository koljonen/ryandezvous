(this.webpackJsonpryandezvous=this.webpackJsonpryandezvous||[]).push([[0],{101:function(e,t,a){e.exports=a(140)},106:function(e,t,a){},108:function(e,t,a){},140:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(9),o=a.n(i),u=(a(106),a(83)),c=a(37),l=a(18),s=a(16),d=a.n(s),m=(a(108),a(14)),p=a.n(m),h=a(75),f=a(7),v=a(24),g=a(17),D=a(29),y=a(31),b=a(22),E=a(32),x=a(76),A=a.n(x),w=a(177),k=a(15),M=a(181),S=a(59),O=a(179),j=a(180),_=a(182),C=a(81),F=a.n(C),Y=a(178),L=a(170),T=a(77),I=a.n(T),q=a(78),R=a.n(q),P=a(79),H=a.n(P),z=Object(L.a)((function(e){return{icon:{color:e.palette.text.secondary,marginRight:e.spacing(2)}}}));function V(e){var t,a,r,n,i;return p.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.term,a=e.id,r="https://kiwiproxy.herokuapp.com/locations/"+(a?"id?id=".concat(a):"/query?&term=".concat(t)),o.next=4,p.a.awrap(fetch(r));case 4:return n=o.sent,o.next=7,p.a.awrap(n.json());case 7:return i=o.sent,o.abrupt("return",i.locations.map((function(e){return Object.assign(e,{input:t||a})})));case 9:case"end":return o.stop()}}))}function W(e){var t=z(),a=n.a.useState(""),r=Object(l.a)(a,2),i=r[0],o=r[1],u=n.a.useState(""),c=Object(l.a)(u,2),s=c[0],d=c[1],m=n.a.useState([]),h=Object(l.a)(m,2),f=h[0],v=h[1],g=n.a.useState(!1),D=Object(l.a)(g,2),y=D[0],b=D[1],E=function(e,t){o(e.target.value)},x=function(t,a){d(a),e.onChange({target:{name:e.name,value:a}})},A=n.a.useMemo((function(){return H()((function(e,t){var a;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.awrap(V({term:e}));case 2:a=r.sent,t(a);case 4:case"end":return r.stop()}}))}),200)}),[]);return n.a.useEffect((function(){var t=!0;if(y){if(""===i)return void v([])}else{if(b(!0),e.value){return void function(){var t,a;p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,p.a.awrap(V({id:e.value}));case 2:t=r.sent,v(t),a=t.filter((function(t){return t.code===e.value||t.id===e.value}))[0],x(0,a);case 6:case"end":return r.stop()}}))}()}e.required||x(0,{name:"Anywhere",code:""})}return A(i,(function(e){t&&v(e||[])})),function(){t=!1}}),[i,A,y,e.value,e.required]),n.a.createElement(_.a,{style:{width:"240px"},getOptionLabel:function(e){return"string"===typeof e?e:e.name},filterOptions:function(e){return e},options:f,onChange:x,value:s,renderInput:function(t){return n.a.createElement(j.a,Object.assign({required:e.required},t,{label:e.label,variant:"outlined",fullWidth:!0,onChange:E}))},renderOption:function(e){var a=I()(e.name,R()(e.name,e.input));return n.a.createElement(w.a,{container:!0,alignItems:"center"},n.a.createElement(w.a,{item:!0},n.a.createElement(F.a,{className:t.icon})),n.a.createElement(w.a,{item:!0,xs:!0},a.map((function(e,t){return n.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)})),n.a.createElement(Y.a,{variant:"body2",color:"textSecondary"},e.name)))}})}function B(){return d()().add((d()().isoWeekday()>=4?12:4)-d()().isoWeekday(),"days")}function J(e){return d()(e).format("DD/MM/YYYY")}function N(e,t){var a;return p.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return a=A()("https://kiwiproxy.herokuapp.com",{path:"v2/search",queryParams:{fly_from:e.id,dateFrom:J(t.departureDate),dateTo:J(t.departureDate),returnFrom:J(t.returnDate),returnTo:J(t.returnDate),curr:"EUR",ret_from_diff_airport:0,fly_to:t.destinationAirport?t.destinationAirport.id:void 0,max_stopovers:0}}).replace(/%2F/g,"/"),r.t0=p.a,r.next=4,p.a.awrap(fetch(a));case 4:return r.t1=r.sent.json(),r.next=7,r.t0.awrap.call(r.t0,r.t1);case 7:return r.abrupt("return",r.sent.data);case 8:case"end":return r.stop()}}))}function U(e){var t,a,r;return p.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return t=function(t,a){var r=new Date(t.route[0].local_arrival),n=new Date(a.route[0].local_arrival),i=new Date(t.route[t.route.length-1].local_arrival),o=new Date(a.route[a.route.length-1].local_arrival),u=Math.abs(r-n),c=Math.abs(i-o),l=Math.min(i,o)-Math.max(r,n),s=u+c;u+c>1296e5||t.cityCodeTo===a.cityCodeTo&&(l<864e5||l<=s||e.candidates.push({day:t.route[0].local_departure,destination:t.cityTo+", "+t.countryTo.name,myArrivalDate:t.route[0].local_arrival,herArrivalDate:a.route[0].local_arrival,myReturnDate:t.route[t.route.length-1].local_arrival,herReturnDate:a.route[a.route.length-1].local_arrival,myDepartureDate:t.route[0].local_departure,herDepartureDate:a.route[0].local_departure,price:t.price+a.price,timeApart:d.a.duration(s),timeTogether:d.a.duration(l),myLink:t.deep_link,herLink:a.deep_link}))},n.next=3,p.a.awrap(N(e.myAirport,e));case 3:return a=n.sent,n.next=6,p.a.awrap(N(e.herAirport,e));case 6:r=n.sent,a.forEach((function(e){r.forEach((function(a){t(e,a)}))}));case 8:case"end":return n.stop()}}))}var G=function(e){function t(e){var a;return Object(v.a)(this,t),(a=Object(D.a)(this,Object(y.a)(t).call(this,e))).handleChange=function(e){this.setState(Object(f.a)({},e.target.name,e.target.value))},a.renderInput=function(e){return e.name},a.state=Object(h.a)({departureDate:B(),returnDate:B().add(4,"days"),destinationAirport:"",candidates:a.props.candidates},e.match.params),a.state.departureDate=d()(a.state.departureDate),a.state.returnDate=d()(a.state.returnDate),a.setLoading=e.setLoading,a.handleChange=a.handleChange.bind(Object(b.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(b.a)(a)),a.doStuff=a.doStuff.bind(Object(b.a)(a)),a}return Object(E.a)(t,e),Object(g.a)(t,[{key:"handleSubmit",value:function(e){e.preventDefault()}},{key:"doStuff",value:function(){return p.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return this.setLoading(!0),this.props.history.push("/".concat(this.state.myAirport.id,"/")+"".concat(this.state.herAirport.id,"/")+"".concat(this.state.departureDate.format("YYYY-MM-DD"),"/")+"".concat(this.state.returnDate.format("YYYY-MM-DD"),"/")+(this.state.destinationAirport&&this.state.destinationAirport.id?"".concat(this.state.destinationAirport.id):"")),e.next=4,p.a.awrap(U(this.state));case 4:this.setLoading(!1);case 5:case"end":return e.stop()}}),null,this)}},{key:"render",value:function(){var e=this;return n.a.createElement("form",{onSubmit:this.handleSubmit},n.a.createElement(w.a,{container:!0,spacing:2},n.a.createElement(w.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(k.a,{name:"departureDate",utils:S.a},n.a.createElement(M.a,{required:!0,variant:"inline",label:"Departure",value:this.state.departureDate,inputVariant:"outlined",onChange:function(t){return e.setState({departureDate:t})}}))),n.a.createElement(w.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(k.a,{name:"returnDate",utils:S.a},n.a.createElement(M.a,{required:!0,variant:"inline",label:"Return",value:this.state.returnDate,inputVariant:"outlined",onChange:function(t){return e.setState({returnDate:t})}}))),n.a.createElement(w.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(W,{required:!0,id:"myAirport",name:"myAirport",value:this.state.myAirport,onChange:this.handleChange,label:"Your origin",renderInput:this.renderInput})),n.a.createElement(w.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(W,{required:!0,id:"herAirport",name:"herAirport",value:this.state.herAirport,onChange:this.handleChange,label:"Their origin",renderInput:this.renderInput})),n.a.createElement(w.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(W,{id:"destinationAirport",name:"destinationAirport",value:this.state.destinationAirport,onChange:this.handleChange,label:"Destination",renderInput:this.renderInput})),n.a.createElement(w.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(O.a,{variant:"contained",color:"primary",onClick:this.doStuff},"Search"))))}}]),t}(n.a.Component),K=(a(125),a(126),a(82));function Q(e){var t=[{title:"Price",field:"price",formatter:"money",formatterParams:{symbol:"\u20ac",precision:0},headerFilter:!0,headerFilterFunc:function(e,t){return e>=t}},{title:"Destination",field:"destination",headerFilter:!0},{title:"You",columns:[{title:"Arrival",field:"myArrivalDate",align:"center",formatter:"datetime",formatterParams:{outputFormat:"ddd DD MMM HH:mm"}},{title:"Return",field:"myReturnDate",align:"center",formatter:"datetime",formatterParams:{outputFormat:"ddd DD MMM HH:mm"}},{title:"Link",field:"myLink",formatter:"link",formatterParams:{label:"Buy",target:"_blank"}}]},{title:"Them",columns:[{title:"Arrival",field:"herArrivalDate",align:"center",formatter:"datetime",formatterParams:{outputFormat:"ddd DD MMM HH:mm"}},{title:"Return",field:"herReturnDate",align:"center",formatter:"datetime",formatterParams:{outputFormat:"ddd DD MMM HH:mm"}},{title:"Link",field:"herLink",formatter:"link",formatterParams:{label:"Buy",target:"_blank"}}]},{title:"Together",field:"timeTogether",formatter:function(e,t,a){return e.getValue().humanize()},sorter:function(e,t){return e.asSeconds()-t.asSeconds()},headerFilter:!0,headerFilterFunc:function(e,t){return X(e)<=t}},{title:"Apart",field:"timeApart",formatter:function(e,t,a){return e.getValue().humanize()},sorter:function(e,t){return e.asSeconds()-t.asSeconds()},headerFilter:!0,headerFilterFunc:function(e,t){return X(e)>=t}}];return n.a.createElement(K.ReactTabulator,{data:e.candidates,columns:t,options:{height:"100%",layout:"fitColumns",reactiveData:!0}})}function X(e){var t=e.split(" "),a="a"===t[0]||"an"===t[0]?1:parseInt(t[0]),r="s"===t[1][t[1].length-1]?t[1]:t[1]+"s";return d.a.duration(a,r)}window.moment=d.a,d.a.updateLocale("en",{week:{dow:1}});var Z=[];function $(e){return n.a.createElement("div",{id:e.id},e.loading?"\u2708":"")}var ee=function(e){var t=n.a.useState(!1),a=Object(l.a)(t,2),r=a[0],i=a[1];return n.a.createElement("div",null,n.a.createElement(G,Object.assign({candidates:Z,setLoading:i},e)),n.a.createElement($,{id:"loading",loading:r}),n.a.createElement(Q,{candidates:Z}))},te=n.a.createElement(u.a,null,n.a.createElement("div",null,n.a.createElement(c.c,null,n.a.createElement(c.a,{exact:!0,path:"/:myAirport/:herAirport/:departureDate/:returnDate",component:ee}),n.a.createElement(c.a,{exact:!0,path:"/:myAirport/:herAirport/:departureDate/:returnDate/:destinationAirport",component:ee}),n.a.createElement(c.a,{exact:!0,path:"/",component:ee}))));o.a.render(te,document.getElementById("root"))}},[[101,1,2]]]);
//# sourceMappingURL=main.37aebe70.chunk.js.map