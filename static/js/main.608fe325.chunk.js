(this.webpackJsonpryandezvous=this.webpackJsonpryandezvous||[]).push([[0],{109:function(e,t,a){e.exports=a(136)},114:function(e,t,a){},118:function(e,t,a){},136:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(12),u=a.n(i),c=(a(114),a(90)),o=a(44),s=a(23),l=a(37),d=a(19),h=a(14),p=a.n(h),f=(a(118),a(7)),m=a(26),y=a(18),g=a(33),b=a(35),v=a(21),x=a(36),O=a(8),D=a.n(O),w=a(81),F=a(51),E=a(92),k=a(57),j=a.n(k),S=a(82),C=a.n(S);function T(e){return p()(e).format("DD/MM/YYYY")}function L(e,t){var a=new Date(e);return a.setDate(a.getDate()+t),a}var _=j()((function(e,t){var a,r,n,i,u,c,o;return D.a.async((function(s){for(;;)switch(s.prev=s.next){case 0:return a=t.dateFlexibility||0,r=L(t.departureDate,-a),n=L(t.departureDate,a),i=L(t.returnDate,-a),u=L(t.returnDate,a),c=C()("https://kiwiproxy.herokuapp.com",{path:"v2/search",queryParams:{fly_from:e.id,dateFrom:T(r),dateTo:T(n),returnFrom:T(i),returnTo:T(u),curr:"EUR",ret_from_diff_airport:0,fly_to:t.destination?t.destination.id:void 0,max_stopovers:t.max_stopovers||0}}).replace(/%2F/g,"/"),s.t0=D.a,s.next=9,D.a.awrap(fetch(c));case 9:return s.t1=s.sent.json(),s.next=12,s.t0.awrap.call(s.t0,s.t1);case 12:return o=s.sent.data,s.abrupt("return",o);case 14:case"end":return s.stop()}}))}),200);function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.forEach((function(e){return I(e)in t?t[I(e)].push(e):t[I(e)]=[e],t}),{}),t}function I(e){return e.cityCodeTo}function M(e){for(var t=e.yourFares,a=e.theirFares,r={},n=0,i=Object.keys(a);n<i.length;n++){var u=i[n];u in t&&(r[u]={yourFares:t[u],theirFares:a[u]})}return r}function R(){return(R=Object(E.a)(D.a.mark((function e(t){var a,r,n,i,u,c,o,s,d,h,p,f,m,y,g,b;return D.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(F.a)(_(t.yourOrigin,t));case 2:return a=e.sent,e.next=5,Object(F.a)(_(t.theirOrigin,t));case 5:return r=e.sent,n=q(a),i=q(r),e.next=10,M({yourFares:n,theirFares:i});case 10:u=0,c=Object.keys(i);case 11:if(!(u<c.length)){e.next=25;break}if(!((o=c[u])in n)){e.next=15;break}return e.abrupt("continue",22);case 15:return e.next=17,Object(F.a)(_(t.yourOrigin,Object(l.a)({},t,{destination:{id:o}})));case 17:return s=e.sent,d=q(s),h=M({yourFares:d,theirFares:i}),e.next=22,h;case 22:u++,e.next=11;break;case 25:p=0,f=Object.keys(n);case 26:if(!(p<f.length)){e.next=40;break}if(!((m=f[p])in i)){e.next=30;break}return e.abrupt("continue",37);case 30:return e.next=32,Object(F.a)(_(t.theirOrigin,Object(l.a)({},t,{destination:{id:m}})));case 32:return y=e.sent,g=q(y),b=M({yourFares:n,theirFares:g}),e.next=37,b;case 37:p++,e.next=26;break;case 40:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Y=function(e){return R.apply(this,arguments)},A=a(175),Q=a(17),W=a(184),J=a(68),N=a(176),B=a(183),H=a(185),P=a(87),z=a.n(P),U=a(52),V=a(169),G=a(83),K=a.n(G),X=a(84),Z=a.n(X);function $(e){var t,a,r,n,i,u;return D.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:if(t=e.url,a=e.expiry,!(r=localStorage.getItem(t))){c.next=9;break}if(!((n=JSON.parse(r)).expiry<Date.now())){c.next=8;break}localStorage.removeItem(t),c.next=9;break;case 8:return c.abrupt("return",n.data);case 9:return c.next=11,D.a.awrap(fetch(t));case 11:return i=c.sent,c.next=14,D.a.awrap(i.json());case 14:return u=c.sent,localStorage.setItem(t,JSON.stringify({data:u,expiry:a})),c.abrupt("return",u);case 17:case"end":return c.stop()}}))}var ee=Object(V.a)((function(e){return{icon:{color:e.palette.text.secondary,marginRight:e.spacing(2)}}})),te=function(e){return D.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,D.a.awrap($({url:e,expiry:new Date(new Date+6048e5)}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}))};function ae(e){var t,a,r,n;return D.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return t=e.term,a=e.id,r="https://kiwiproxy.herokuapp.com/locations/"+(a?"id?id=".concat(a):"/query?&term=".concat(t)),i.next=4,D.a.awrap(te(r));case 4:return n=i.sent,i.abrupt("return",n.locations.map((function(e){return Object.assign(e,{input:t||a})})));case 6:case"end":return i.stop()}}))}function re(e){var t=ee(),a=n.a.useState(""),r=Object(d.a)(a,2),i=r[0],u=r[1],c=n.a.useState([]),o=Object(d.a)(c,2),s=o[0],l=o[1],h=function(e,t){u(e.target.value)},p=n.a.useMemo((function(){return j()((function(e,t){var a;return D.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,D.a.awrap(ae({term:e}));case 2:a=r.sent,t(a);case 4:case"end":return r.stop()}}))}),200)}),[]);return n.a.useEffect((function(){var e=!0;if(""!==i)return p(i,(function(t){e&&l(t||[])})),function(){e=!1};l([])}),[i,p]),n.a.createElement(H.a,{style:{width:"240px"},getOptionLabel:function(e){return"string"===typeof e?e:e.name},filterOptions:function(e){return e},options:s,onChange:function(t,a){e.onChange({target:{name:e.name,value:a}})},value:e.value,renderInput:function(t){return n.a.createElement(B.a,Object.assign({required:e.required},t,{label:e.label,variant:"outlined",fullWidth:!0,onChange:h}))},renderOption:function(e){var a=K()(e.name,Z()(e.name,e.input));return n.a.createElement(A.a,{container:!0,alignItems:"center"},n.a.createElement(A.a,{item:!0},n.a.createElement(z.a,{className:t.icon})),n.a.createElement(A.a,{item:!0,xs:!0},a.map((function(e,t){return n.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)})),n.a.createElement(U.a,{variant:"body2",color:"textSecondary"},e.name)))}})}function ne(){return p()().add((p()().isoWeekday()>=4?12:4)-p()().isoWeekday(),"days")}var ie=["departureDate","returnDate","yourOrigin","theirOrigin"];function ue(e,t){var a,r,n;return D.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t[e]){i.next=9;break}return a="https://kiwiproxy.herokuapp.com/locations/id?id=".concat(t[e]),i.next=4,D.a.awrap(fetch(a));case 4:return r=i.sent,i.next=7,D.a.awrap(r.json());case 7:n=i.sent,t[e]=n.locations.filter((function(a){return a.id===t[e]}))[0];case 9:case"end":return i.stop()}}))}var ce=function(e){function t(e){var a,r,n,i;return Object(m.a)(this,t),(a=Object(g.a)(this,Object(b.a)(t).call(this,e))).handleChange=function(e){this.setState(Object(f.a)({},e.target.name,e.target.value))},a.renderInput=function(e){return e.name},a.state=Object(l.a)({departureDate:ne(),returnDate:ne().add(4,"days"),destination:""},e.query),a.state.departureDate=p()(a.state.departureDate),a.state.returnDate=p()(a.state.returnDate),a.allowSubmit=a.allowSubmit.bind(Object(v.a)(a)),a.startLoading=e.startLoading,a.finishLoading=e.finishLoading,a.handleChange=a.handleChange.bind(Object(v.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(v.a)(a)),a.doStuff=a.doStuff.bind(Object(v.a)(a)),a.setDepartureDate=a.setDepartureDate.bind(Object(v.a)(a)),r=a.state,n=a.allowSubmit,i=a.doStuff,D.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.a.awrap(ue("yourOrigin",r));case 2:return e.next=4,D.a.awrap(ue("theirOrigin",r));case 4:return e.next=6,D.a.awrap(ue("destination",r));case 6:n()&&i();case 7:case"end":return e.stop()}})),a}return Object(x.a)(t,e),Object(y.a)(t,[{key:"componentDidUpdate",value:function(e,t,a){var r=this.setState.bind(this),n=e.query,i=this.props.query;function u(e){var t;return D.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(i[e]===n[e]){a.next=6;break}return(t={})[e]=i[e],a.next=5,D.a.awrap(ue(e,t));case 5:r(t);case 6:case"end":return a.stop()}}))}i.returnDate!==n.returnDate&&this.setState({returnDate:p()(i.returnDate)}),i.dateFlexibility!==n.dateFlexibility&&this.setState({dateFlexibility:i.dateFlexibility}),i.max_stopovers!==n.max_stopovers&&this.setState({max_stopovers:i.max_stopovers}),i.departureDate!==n.departureDate&&this.setDepartureDate(i.departureDate),u("yourOrigin"),u("theirOrigin"),u("destination")}},{key:"handleSubmit",value:function(e){e.preventDefault()}},{key:"allowSubmit",value:function(){var e=this;return ie.reduce((function(t,a){return t&&!!e.state[a]}),!0)&&!this.props.loading}},{key:"setDepartureDate",value:function(e){e>this.state.returnDate&&this.setState({returnDate:p()(this.state.returnDate+(e-this.state.departureDate))}),this.setState({departureDate:p()(e)})}},{key:"doStuff",value:function(){var e,t,a,r,n,i,u;return D.a.async((function(c){for(;;)switch(c.prev=c.next){case 0:return this.startLoading(),this.props.clearCandidates(),this.props.setQuery({yourOrigin:this.state.yourOrigin.id,theirOrigin:this.state.theirOrigin.id,destination:this.state.destination?this.state.destination.id:void 0,departureDate:this.state.departureDate.toDate(),returnDate:this.state.returnDate.toDate()}),e=!0,t=!1,c.prev=5,c.t0=w.a,c.next=9,D.a.awrap(Y(this.state));case 9:c.t1=c.sent,r=(0,c.t0)(c.t1);case 11:return c.next=13,D.a.awrap(r.next());case 13:return n=c.sent,e=n.done,c.next=17,D.a.awrap(n.value);case 17:if(i=c.sent,e){c.next=24;break}u=i,this.props.addCandidates(u);case 21:e=!0,c.next=11;break;case 24:c.next=30;break;case 26:c.prev=26,c.t2=c.catch(5),t=!0,a=c.t2;case 30:if(c.prev=30,c.prev=31,e||null==r.return){c.next=35;break}return c.next=35,D.a.awrap(r.return());case 35:if(c.prev=35,!t){c.next=38;break}throw a;case 38:return c.finish(35);case 39:return c.finish(30);case 40:this.finishLoading();case 41:case"end":return c.stop()}}),null,this,[[5,26,30,40],[31,,35,39]])}},{key:"render",value:function(){var e=this;return n.a.createElement("form",{onSubmit:this.handleSubmit},n.a.createElement(A.a,{container:!0,spacing:2},n.a.createElement(A.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(Q.a,{name:"departureDate",utils:J.a},n.a.createElement(W.a,{required:!0,disablePast:!0,variant:"inline",label:"Departure",value:this.state.departureDate,inputVariant:"outlined",onChange:this.setDepartureDate}))),n.a.createElement(A.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(Q.a,{name:"returnDate",utils:J.a},n.a.createElement(W.a,{required:!0,variant:"inline",label:"Return",value:this.state.returnDate,inputVariant:"outlined",onChange:function(t){return e.setState({returnDate:t})},minDate:this.state.departureDate}))),n.a.createElement(A.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(re,{startLoading:this.startLoading,finishLoading:this.finishLoading,required:!0,id:"yourOrigin",name:"yourOrigin",value:this.state.yourOrigin,onChange:this.handleChange,label:"Your origin",renderInput:this.renderInput})),n.a.createElement(A.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(re,{startLoading:this.startLoading,finishLoading:this.finishLoading,required:!0,id:"theirOrigin",name:"theirOrigin",value:this.state.theirOrigin,onChange:this.handleChange,label:"Their origin",renderInput:this.renderInput})),n.a.createElement(A.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(re,{startLoading:this.startLoading,finishLoading:this.finishLoading,id:"destination",name:"destination",value:this.state.destination,onChange:this.handleChange,label:"Destination",renderInput:this.renderInput})),n.a.createElement(A.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(N.a,{variant:"contained",color:"primary",disabled:!this.allowSubmit(),onClick:this.doStuff},"Search"))))}}]),t}(n.a.Component),oe=a(16),se=a(88),le=a(179),de=a(181),he=a(137),pe=a(186),fe=a(177),me=a(178),ye=a(190),ge=a(180),be=a(182);function ve(e){var t=-1!==Object.keys(e.candidates).indexOf(e.query.expand)&&e.query.expand;return n.a.createElement(he.a,null,n.a.createElement(pe.a,{value:t,onChange:function(t,a){e.setQuery({expand:a,theirFlight:null,yourFlight:null})}},Object.values(e.candidates).map((function(e){var t=e.yourFares[0],a=xe(e.yourFares)+xe(e.theirFares),r="\u20ac ".concat(a," ").concat(t.cityTo,", ").concat(t.countryTo.name);return n.a.createElement(fe.a,{key:t.cityCodeTo,value:t.cityCodeTo,label:r})}))),n.a.createElement(we,{cityCodeTo:e.query.expand,yourFlight:e.query.yourFlight,theirFlight:e.query.theirFlight,candidates:e.candidates,setYourFlight:function(t){return e.setQuery({yourFlight:t})},setTheirFlight:function(t){return e.setQuery({theirFlight:t})}}),n.a.createElement(Fe,{yourFlight:e.query.yourFlight,theirFlight:e.query.theirFlight,flights:e.candidates[e.query.expand]}))}function xe(e){return Math.min.apply(Math,Object(oe.a)(e.map((function(e){return e.price}))))}function Oe(e){return p()(e).format("DD MMM HH:mm")}function De(e,t){return e.map((function(e){return Object(l.a)({},e,{},{yoursOrTheirs:t})}))}function we(e){var t=e.cityCodeTo,a=e.candidates,r=e.yourFlight,i=e.theirFlight,u=e.setYourFlight,c=e.setTheirFlight;if(r&&i)return null;if(!(t in a))return null;var o=[].concat(Object(oe.a)(De(a[t].yourFares,"yours")),Object(oe.a)(De(a[t].theirFares,"theirs")));o.sort((function(e,t){return e.id===i||e.id===r?-1:t.id===i||t.id===r?1:Math.sign(e.price-t.price)}));var s=[[{type:"string",id:"id"},{type:"string",id:"label"},{type:"string",role:"style"},{type:"string",role:"tooltip",p:{html:!0}},{type:"date",id:"Start"},{type:"date",id:"End"}]].concat(Object(oe.a)(o.map((function(e){return function(e){var t=e.fare,a=e.yourFlight,r=e.theirFlight,n=a||r;if(a&&"yours"===t.yoursOrTheirs&&t.id!==a)return null;if(r&&"theirs"===t.yoursOrTheirs&&t.id!==r)return null;var i=t.route[t.route.length-1],u="\u20ac ".concat(t.price),c="".concat(t.flyFrom," -> ").concat(t.flyTo," ").concat(Oe(t.local_departure)," \u2013 ").concat(Oe(t.local_arrival)),o="".concat(i.flyFrom," -> ").concat(i.flyTo," ").concat(Oe(i.local_departure)," \u2013 ").concat(Oe(i.local_arrival)),s="".concat(u," | ").concat(c," | ").concat(o),l="".concat(u,"<br/>").concat(c,"<br/>").concat(o),d={theirs:["#DC3912","#FFAAAA"],yours:["#3366CC","#88AAFF"]}[t.yoursOrTheirs],h=t.id===n?d[1]:d[0],p=t.id===n?d[0]:d[1];return[[t.id,"","color: ".concat(h,";"),l,new Date(t.utc_departure),new Date(t.utc_arrival)],[t.id,s,"color: ".concat(p,";"),l,new Date(t.utc_arrival),new Date(i.utc_departure)],[t.id,"","color: ".concat(h,";"),l,new Date(i.utc_departure),new Date(i.utc_arrival)]]}({fare:e,yourFlight:r,theirFlight:i})})).filter((function(e){return e})).flat())),l=[{eventName:"select",callback:function(e){var t=e.chartWrapper.getChart().getSelection(),a=s[t[0].row][0],n=o.filter((function(e){return e.id===a}))[0];"yours"===n.yoursOrTheirs?n.id===r?u(""):u(n.id):"theirs"===n.yoursOrTheirs?n.id===i?c(""):c(n.id):console.error("unexpected yoursOrTheirs",n.yoursOrTheirs)}}];return n.a.createElement(se.a,{width:"100%",height:r&&i?"200px":"800px",chartType:"Timeline",loader:n.a.createElement("div",null,"Loading Chart"),data:s,chartEvents:l,options:{timeline:{colorByRowLabel:!1,groupByRowLabel:!0,showRowLabels:!1},tooltip:{isHtml:!0}},rootProps:{"data-testid":"1"}})}function Fe(e){var t=e.yourFlight,a=e.theirFlight,r=e.flights;if(!r)return null;var i=a&&r.theirFares.filter((function(e){return e.id===a}))[0],u=t&&r.yourFares.filter((function(e){return e.id===t}))[0];return i||u?n.a.createElement(he.a,null,n.a.createElement(A.a,{container:!0,spacing:10},i&&n.a.createElement(Ee,{flight:i}),u&&n.a.createElement(Ee,{flight:u}))):null}function Ee(e){var t=e.flight;return n.a.createElement(A.a,{item:!0},n.a.createElement(me.a,null,n.a.createElement(le.a,{title:"".concat(t.cityFrom," -> ").concat(t.cityTo)}),t.route.map((function(e){return n.a.createElement("div",{key:e.id},n.a.createElement(ye.a,{src:"https://images.kiwi.com/airlines/64/".concat(e.airline,".png")}),n.a.createElement(ge.a,null,Oe(e.local_departure)," ",e.cityFrom," (",e.flyFrom,")",n.a.createElement("br",null),Oe(e.local_arrival)," ",e.cityTo," (",e.flyTo,")"))})),n.a.createElement(de.a,null,n.a.createElement(be.a,{target:"_blank",rel:"noopener",href:t.deep_link},"\u20ac ",t.price))))}function ke(e){return n.a.createElement("div",{id:e.id},e.loading?"\u2708":"")}window.moment=p.a,p.a.updateLocale("en",{week:{dow:1}});var je=function(e){var t=Object(s.e)({destination:s.d,theirOrigin:s.d,yourOrigin:s.d,departureDate:s.a,returnDate:s.a,dateFlexibility:s.b,max_stopovers:s.b,expand:s.d,yourFlight:s.d,theirFlight:s.d}),a=Object(d.a)(t,2),r=a[0],i=a[1],u=n.a.useState(0),c=Object(d.a)(u,2),o=c[0],h=c[1],p=n.a.useState({}),f=Object(d.a)(p,2),m=f[0],y=f[1];return n.a.createElement("div",null,n.a.createElement(ce,{addCandidates:function(e){return y(Object(l.a)({},m,{},e))},clearCandidates:function(){return y([])},startLoading:function(){return h(o+1)},finishLoading:function(){return h(o-1)},loading:o>0,query:r,setQuery:i}),n.a.createElement(ke,{id:"loading",loading:o>0}),n.a.createElement(ve,{candidates:m,setQuery:i,query:r}))},Se=n.a.createElement(c.a,null,n.a.createElement(s.c,{ReactRouterRoute:o.a},n.a.createElement(je,null)));u.a.render(Se,document.getElementById("root"))}},[[109,1,2]]]);
//# sourceMappingURL=main.608fe325.chunk.js.map