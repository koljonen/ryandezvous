(this.webpackJsonpryandezvous=this.webpackJsonpryandezvous||[]).push([[0],{105:function(e,t,a){e.exports=a(144)},110:function(e,t,a){},112:function(e,t,a){},144:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),i=a(9),o=a.n(i),u=(a(110),a(63)),s=a(37),c=a(18),l=a(21),d=a(14),p=a.n(d),m=(a(112),a(47)),h=a(7),f=a(24),v=a(17),D=a(29),b=a(31),g=a(19),y=a(32),x=a(11),A=a.n(x),k=a(80),w=a(48),E=a(88),j=a(52),O=a.n(j),S=a(81),L=a.n(S);function F(e){return p()(e).format("DD/MM/YYYY")}var C=O()((function(e,t){var a,r;return A.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return a=L()("https://kiwiproxy.herokuapp.com",{path:"v2/search",queryParams:{fly_from:e.id,dateFrom:F(t.departureDate),dateTo:F(t.departureDate),returnFrom:F(t.returnDate),returnTo:F(t.returnDate),curr:"EUR",ret_from_diff_airport:0,fly_to:t.destinationAirport?t.destinationAirport.id:void 0,max_stopovers:0}}).replace(/%2F/g,"/"),n.t0=A.a,n.next=4,A.a.awrap(fetch(a));case 4:return n.t1=n.sent.json(),n.next=7,n.t0.awrap.call(n.t0,n.t1);case 7:return r=n.sent.data,n.abrupt("return",r);case 9:case"end":return n.stop()}}))}),200);function M(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.forEach((function(e){return _(e)in t?t[_(e)].push(e):t[_(e)]=[e],t}),{}),t}function _(e){return e.cityCodeTo}function Y(e,t,a){var r=new Date(e.route[0].local_arrival),n=new Date(t.route[0].local_arrival),i=new Date(e.route[e.route.length-1].local_arrival),o=new Date(t.route[t.route.length-1].local_arrival),u=Math.abs(r-n),s=Math.abs(i-o),c=Math.min(i,o)-Math.max(r,n),l=u+s;u+s>1296e5||e.cityCodeTo===t.cityCodeTo&&(c<864e5||c<=l||a.push({day:e.route[0].local_departure,destination:e.cityTo+", "+e.countryTo.name,myArrivalDate:e.route[0].local_arrival,herArrivalDate:t.route[0].local_arrival,myReturnDate:e.route[e.route.length-1].local_arrival,herReturnDate:t.route[t.route.length-1].local_arrival,myDepartureDate:e.route[0].local_departure,herDepartureDate:t.route[0].local_departure,price:e.price+t.price,timeApart:p.a.duration(l),timeTogether:p.a.duration(c),myLink:e.deep_link,herLink:t.deep_link}))}function T(e){var t=e.myFaresArray,a=e.herFaresDict,r=e.revertParams,n=void 0!==r&&r,i=[];return t.forEach((function(e){var t=a[_(e)];t&&t.forEach((function(t){n?Y(t,e,i):Y(e,t,i)}))})),i}function P(){return(P=Object(E.a)(A.a.mark((function e(t){var a,r,n,i,o,u,s,c,l,d,p,h,f,v;return A.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(w.a)(C(t.myAirport,t));case 2:return a=e.sent,e.next=5,Object(w.a)(C(t.herAirport,t));case 5:return r=e.sent,n=M(a),i=M(r),e.next=10,T({myFaresArray:a,herFaresDict:i});case 10:o=0,u=Object.keys(i);case 11:if(!(o<u.length)){e.next=24;break}if(!((s=u[o])in n)){e.next=15;break}return e.abrupt("continue",21);case 15:return e.next=17,Object(w.a)(C(t.myAirport,Object(m.a)({},t,{destinationAirport:{id:s}})));case 17:return c=e.sent,l=T({myFaresArray:c,herFaresDict:i}),e.next=21,l;case 21:o++,e.next=11;break;case 24:d=0,p=Object.keys(n);case 25:if(!(d<p.length)){e.next=38;break}if(!((h=p[d])in i)){e.next=29;break}return e.abrupt("continue",35);case 29:return e.next=31,Object(w.a)(C(t.herAirport,Object(m.a)({},t,{destinationAirport:{id:h}})));case 31:return f=e.sent,v=T({myFaresArray:f,herFaresDict:n,revertParams:!0}),e.next=35,v;case 35:d++,e.next=25;break;case 38:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var I=function(e){return P.apply(this,arguments)},R=a(181),q=a(16),H=a(185),z=a(64),U=a(183),V=a(184),W=a(186),B=a(85),J=a.n(B),N=a(182),G=a(174),K=a(82),Q=a.n(K),X=a(83),Z=a.n(X),$=Object(G.a)((function(e){return{icon:{color:e.palette.text.secondary,marginRight:e.spacing(2)}}}));function ee(e){var t,a,r,n,i;return A.a.async((function(o){for(;;)switch(o.prev=o.next){case 0:return t=e.term,a=e.id,r="https://kiwiproxy.herokuapp.com/locations/"+(a?"id?id=".concat(a):"/query?&term=".concat(t)),o.next=4,A.a.awrap(fetch(r));case 4:return n=o.sent,o.next=7,A.a.awrap(n.json());case 7:return i=o.sent,o.abrupt("return",i.locations.map((function(e){return Object.assign(e,{input:t||a})})));case 9:case"end":return o.stop()}}))}function te(e){var t=$(),a=n.a.useState(""),r=Object(l.a)(a,2),i=r[0],o=r[1],u=n.a.useState([]),s=Object(l.a)(u,2),c=s[0],d=s[1],p=function(e,t){o(e.target.value)},m=n.a.useMemo((function(){return O()((function(e,t){var a;return A.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,A.a.awrap(ee({term:e}));case 2:a=r.sent,t(a);case 4:case"end":return r.stop()}}))}),200)}),[]);return n.a.useEffect((function(){var e=!0;if(""!==i)return m(i,(function(t){e&&d(t||[])})),function(){e=!1};d([])}),[i,m]),n.a.createElement(W.a,{style:{width:"240px"},getOptionLabel:function(e){return"string"===typeof e?e:e.name},filterOptions:function(e){return e},options:c,onChange:function(t,a){e.onChange({target:{name:e.name,value:a}})},value:e.value,renderInput:function(t){return n.a.createElement(V.a,Object.assign({required:e.required},t,{label:e.label,variant:"outlined",fullWidth:!0,onChange:p}))},renderOption:function(e){var a=Q()(e.name,Z()(e.name,e.input));return n.a.createElement(R.a,{container:!0,alignItems:"center"},n.a.createElement(R.a,{item:!0},n.a.createElement(J.a,{className:t.icon})),n.a.createElement(R.a,{item:!0,xs:!0},a.map((function(e,t){return n.a.createElement("span",{key:t,style:{fontWeight:e.highlight?700:400}},e.text)})),n.a.createElement(N.a,{variant:"body2",color:"textSecondary"},e.name)))}})}function ae(){return p()().add((p()().isoWeekday()>=4?12:4)-p()().isoWeekday(),"days")}var re=["departureDate","returnDate","myAirport","herAirport"];function ne(e,t){var a,r,n;return A.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:if(!t[e]){i.next=9;break}return a="https://kiwiproxy.herokuapp.com/locations/id?id=".concat(t[e]),i.next=4,A.a.awrap(fetch(a));case 4:return r=i.sent,i.next=7,A.a.awrap(r.json());case 7:n=i.sent,t[e]=n.locations.filter((function(a){return a.code===t[e]}))[0];case 9:case"end":return i.stop()}}))}var ie=function(e){function t(e){var a,r,n,i;return Object(f.a)(this,t),(a=Object(D.a)(this,Object(b.a)(t).call(this,e))).handleChange=function(e){this.setState(Object(h.a)({},e.target.name,e.target.value))},a.renderInput=function(e){return e.name},a.state=Object(m.a)({departureDate:ae(),returnDate:ae().add(4,"days"),destinationAirport:""},e.match.params),a.state.departureDate=p()(a.state.departureDate),a.state.returnDate=p()(a.state.returnDate),a.allowSubmit=a.allowSubmit.bind(Object(g.a)(a)),a.startLoading=e.startLoading,a.finishLoading=e.finishLoading,a.handleChange=a.handleChange.bind(Object(g.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(g.a)(a)),a.doStuff=a.doStuff.bind(Object(g.a)(a)),a.componentDidUpdate=a.componentDidUpdate.bind(Object(g.a)(a)),a.setDepartureDate=a.setDepartureDate.bind(Object(g.a)(a)),r=a.state,n=a.allowSubmit,i=a.doStuff,A.a.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,A.a.awrap(ne("myAirport",r));case 2:return e.next=4,A.a.awrap(ne("herAirport",r));case 4:return e.next=6,A.a.awrap(ne("destinationAirport",r));case 6:n()&&i();case 7:case"end":return e.stop()}})),a}return Object(y.a)(t,e),Object(v.a)(t,[{key:"componentDidUpdate",value:function(e,t,a){var r=this.setState.bind(this),n=e.match.params,i=this.props.match.params;function o(e){var t;return A.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:if(i[e]===n[e]){a.next=6;break}return(t={})[e]=i[e],a.next=5,A.a.awrap(ne(e,t));case 5:r(t);case 6:case"end":return a.stop()}}))}i.returnDate!==n.returnDate&&this.setState({returnDate:p()(i.returnDate)}),i.departureDate!==n.departureDate&&this.setDepartureDate(i.departureDate),o("myAirport"),o("herAirport"),o("destinationAirport")}},{key:"handleSubmit",value:function(e){e.preventDefault()}},{key:"allowSubmit",value:function(){var e=this;return re.reduce((function(t,a){return t&&!!e.state[a]}),!0)&&!this.props.loading}},{key:"setDepartureDate",value:function(e){e>this.state.returnDate&&this.setState({returnDate:p()(this.state.returnDate+(e-this.state.departureDate))}),this.setState({departureDate:e})}},{key:"doStuff",value:function(){var e,t,a,r,n,i,o;return A.a.async((function(u){for(;;)switch(u.prev=u.next){case 0:return this.startLoading(),this.props.clearCandidates(),this.props.history.push("/".concat(this.state.myAirport.id,"/")+"".concat(this.state.herAirport.id,"/")+"".concat(this.state.departureDate.format("YYYY-MM-DD"),"/")+"".concat(this.state.returnDate.format("YYYY-MM-DD"),"/")+(this.state.destinationAirport&&this.state.destinationAirport.id?"".concat(this.state.destinationAirport.id):"")),e=!0,t=!1,u.prev=5,u.t0=k.a,u.next=9,A.a.awrap(I(this.state));case 9:u.t1=u.sent,r=(0,u.t0)(u.t1);case 11:return u.next=13,A.a.awrap(r.next());case 13:return n=u.sent,e=n.done,u.next=17,A.a.awrap(n.value);case 17:if(i=u.sent,e){u.next=24;break}o=i,this.props.addCandidates(o);case 21:e=!0,u.next=11;break;case 24:u.next=30;break;case 26:u.prev=26,u.t2=u.catch(5),t=!0,a=u.t2;case 30:if(u.prev=30,u.prev=31,e||null==r.return){u.next=35;break}return u.next=35,A.a.awrap(r.return());case 35:if(u.prev=35,!t){u.next=38;break}throw a;case 38:return u.finish(35);case 39:return u.finish(30);case 40:this.finishLoading();case 41:case"end":return u.stop()}}),null,this,[[5,26,30,40],[31,,35,39]])}},{key:"render",value:function(){var e=this;return n.a.createElement("form",{onSubmit:this.handleSubmit},n.a.createElement(R.a,{container:!0,spacing:2},n.a.createElement(R.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(q.a,{name:"departureDate",utils:z.a},n.a.createElement(H.a,{required:!0,disablePast:!0,variant:"inline",label:"Departure",value:this.state.departureDate,inputVariant:"outlined",onChange:this.setDepartureDate}))),n.a.createElement(R.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(q.a,{name:"returnDate",utils:z.a},n.a.createElement(H.a,{required:!0,variant:"inline",label:"Return",value:this.state.returnDate,inputVariant:"outlined",onChange:function(t){return e.setState({returnDate:t})},minDate:this.state.departureDate}))),n.a.createElement(R.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(te,{startLoading:this.startLoading,finishLoading:this.finishLoading,required:!0,id:"myAirport",name:"myAirport",value:this.state.myAirport,onChange:this.handleChange,label:"Your origin",renderInput:this.renderInput})),n.a.createElement(R.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(te,{startLoading:this.startLoading,finishLoading:this.finishLoading,required:!0,id:"herAirport",name:"herAirport",value:this.state.herAirport,onChange:this.handleChange,label:"Their origin",renderInput:this.renderInput})),n.a.createElement(R.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(te,{startLoading:this.startLoading,finishLoading:this.finishLoading,id:"destinationAirport",name:"destinationAirport",value:this.state.destinationAirport,onChange:this.handleChange,label:"Destination",renderInput:this.renderInput})),n.a.createElement(R.a,{item:!0,sm:6,md:3,xl:2},n.a.createElement(U.a,{variant:"contained",color:"primary",disabled:!this.allowSubmit(),onClick:this.doStuff},"Search"))))}}]),t}(n.a.Component),oe=Object(s.f)(ie),ue=(a(130),a(131),a(87));function se(e){var t=[{title:"Price",field:"price",formatter:"money",formatterParams:{symbol:"\u20ac",precision:0},headerFilter:!0,headerFilterFunc:function(e,t){return e>=t}},{title:"Destination",field:"destination",headerFilter:!0},{title:"You",columns:[{title:"Arrival",field:"myArrivalDate",align:"center",formatter:"datetime",formatterParams:{outputFormat:"ddd DD MMM HH:mm"}},{title:"Return",field:"myReturnDate",align:"center",formatter:"datetime",formatterParams:{outputFormat:"ddd DD MMM HH:mm"}},{title:"Link",field:"myLink",formatter:"link",formatterParams:{label:"Buy",target:"_blank"}}]},{title:"Them",columns:[{title:"Arrival",field:"herArrivalDate",align:"center",formatter:"datetime",formatterParams:{outputFormat:"ddd DD MMM HH:mm"}},{title:"Return",field:"herReturnDate",align:"center",formatter:"datetime",formatterParams:{outputFormat:"ddd DD MMM HH:mm"}},{title:"Link",field:"herLink",formatter:"link",formatterParams:{label:"Buy",target:"_blank"}}]},{title:"Together",field:"timeTogether",formatter:function(e,t,a){return e.getValue().humanize()},sorter:function(e,t){return e.asSeconds()-t.asSeconds()},headerFilter:!0,headerFilterFunc:function(e,t){return ce(e)<=t}},{title:"Apart",field:"timeApart",formatter:function(e,t,a){return e.getValue().humanize()},sorter:function(e,t){return e.asSeconds()-t.asSeconds()},headerFilter:!0,headerFilterFunc:function(e,t){return ce(e)>=t}}];return n.a.createElement(ue.ReactTabulator,{data:e.candidates,columns:t,options:{height:"100%",layout:"fitColumns",reactiveData:!0}})}function ce(e){var t=e.split(" "),a="a"===t[0]||"an"===t[0]?1:parseInt(t[0]),r="s"===t[1][t[1].length-1]?t[1]:t[1]+"s";return p.a.duration(a,r)}function le(e){return n.a.createElement("div",{id:e.id},e.loading?"\u2708":"")}window.moment=p.a,p.a.updateLocale("en",{week:{dow:1}});var de=function(e){var t=n.a.useState(0),a=Object(l.a)(t,2),r=a[0],i=a[1],o=n.a.useState([]),u=Object(l.a)(o,2),s=u[0],d=u[1];return n.a.createElement("div",null,n.a.createElement(oe,{addCandidates:function(e){return d([].concat(Object(c.a)(s),Object(c.a)(e)))},clearCandidates:function(){return d([])},startLoading:function(){return i(r+1)},finishLoading:function(){return i(r-1)},loading:r>0}),n.a.createElement(le,{id:"loading",loading:r>0}),n.a.createElement(se,{candidates:s}))},pe=n.a.createElement(u.a,null,n.a.createElement("div",null,n.a.createElement(s.c,null,n.a.createElement(s.a,{exact:!0,path:"/:myAirport/:herAirport/:departureDate/:returnDate",component:de}),n.a.createElement(s.a,{exact:!0,path:"/:myAirport/:herAirport/:departureDate/:returnDate/:destinationAirport",component:de}),n.a.createElement(s.a,{exact:!0,path:"/",component:de}))));o.a.render(pe,document.getElementById("root"))}},[[105,1,2]]]);
//# sourceMappingURL=main.2173097c.chunk.js.map